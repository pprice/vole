// Integration tests for the module import system with std:math
let math = import "std:math"

tests {
    // Tests for native math functions (defined via external block)
    test "math.sqrt" {
        assert(math.sqrt(4.0) == 2.0)
        assert(math.sqrt(16.0) == 4.0)
    }

    test "math.pow" {
        assert(math.pow(2.0, 3.0) == 8.0)
    }

    test "math.abs" {
        assert(math.abs(-5.0) == 5.0)
        assert(math.abs(5.0) == 5.0)
    }

    test "math.min and max" {
        assert(math.min(3.0, 5.0) == 3.0)
        assert(math.max(3.0, 5.0) == 5.0)
    }

    test "math.floor and ceil" {
        assert(math.floor(3.7) == 3.0)
        assert(math.ceil(3.2) == 4.0)
    }

    test "math.round" {
        assert(math.round(3.5) == 4.0)
        assert(math.round(3.4) == 3.0)
    }

    test "math.sin and cos" {
        // sin(0) = 0, cos(0) = 1
        assert(math.sin(0.0) == 0.0)
        assert(math.cos(0.0) == 1.0)
    }

    test "math.tan" {
        // tan(0) = 0
        assert(math.tan(0.0) == 0.0)
    }

    // Test for module constant (let binding)
    test "math.PI" {
        assert(math.PI > 3.14)
        assert(math.PI < 3.15)
    }

    // Tests for pure Vole functions (defined in math.vole, not external)
    test "math.lerp" {
        // lerp(0, 10, 0.5) should be 5
        assert(math.lerp(0.0, 10.0, 0.5) == 5.0)
        // lerp(0, 10, 0) should be 0
        assert(math.lerp(0.0, 10.0, 0.0) == 0.0)
        // lerp(0, 10, 1) should be 10
        assert(math.lerp(0.0, 10.0, 1.0) == 10.0)
    }

    // Pure Vole function that calls external FFI functions (min, max)
    test "math.clamp" {
        // clamp(5, 0, 10) = 5 (within range)
        assert(math.clamp(5.0, 0.0, 10.0) == 5.0)
        // clamp(-5, 0, 10) = 0 (below range)
        assert(math.clamp(-5.0, 0.0, 10.0) == 0.0)
        // clamp(15, 0, 10) = 10 (above range)
        assert(math.clamp(15.0, 0.0, 10.0) == 10.0)
    }

    // Pure Vole functions that use module constants (PI)
    test "math.deg_to_rad" {
        // 180 degrees = PI radians
        let rad = math.deg_to_rad(180.0)
        assert(rad > 3.14)
        assert(rad < 3.15)
        // 0 degrees = 0 radians
        assert(math.deg_to_rad(0.0) == 0.0)
    }

    test "math.rad_to_deg" {
        // PI radians = 180 degrees
        let deg = math.rad_to_deg(math.PI)
        assert(deg > 179.9)
        assert(deg < 180.1)
        // 0 radians = 0 degrees
        assert(math.rad_to_deg(0.0) == 0.0)
    }
}
