// Generic Structural Constraint Tests

// Types that satisfy HasName constraint
class Person {
    name: string,
    age: i32,
}

class Animal {
    name: string,
    species: string,
}

// Implement greet method for Person
implement Person {
    func greet() -> string {
        return "Hello, " + self.name
    }
}

// Function with structural field constraint
func getName<T: { name: string }>(x: T) -> string {
    return x.name
}

// Function with structural method constraint
func callGreet<T: { func greet() -> string }>(x: T) -> string {
    return x.greet()
}

tests {

    test "generics::constraints::basic field constraint" {
        let p = Person { name: "Alice", age: 30 }
        let result = getName(p)
        assert(result == "Alice")
    }

    test "generics::constraints::different type same constraint" {
        let a = Animal { name: "Fluffy", species: "Cat" }
        let result = getName(a)
        assert(result == "Fluffy")
    }

    test "generics::constraints::method constraint" {
        let p = Person { name: "Bob", age: 25 }
        let result = callGreet(p)
        assert(result == "Hello, Bob")
    }
}

func main() {
    // Entry point
}
