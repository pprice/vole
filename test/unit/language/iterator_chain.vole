// Test iterator chain() method

tests {
    test "chain two arrays" {
        let a = [1, 2, 3]
        let b = [4, 5, 6]
        let result = a.iter().chain(b.iter()).collect()
        assert(result.length() == 6)
        assert(result[0] == 1)
        assert(result[3] == 4)
        assert(result[5] == 6)
    }

    test "chain empty with non-empty" {
        let empty: [i64] = []
        let arr = [1, 2, 3]
        let result = empty.iter().chain(arr.iter()).collect()
        assert(result.length() == 3)
        assert(result[0] == 1)
    }

    test "chain non-empty with empty" {
        let arr = [1, 2, 3]
        let empty: [i64] = []
        let result = arr.iter().chain(empty.iter()).collect()
        assert(result.length() == 3)
        assert(result[0] == 1)
    }

    test "chain two empty arrays" {
        let a: [i64] = []
        let b: [i64] = []
        let result = a.iter().chain(b.iter()).collect()
        assert(result.length() == 0)
    }

    test "chain with map" {
        let a = [1, 2]
        let b = [3, 4]
        let result = a.iter().chain(b.iter()).map((x) => x * 2).collect()
        assert(result.length() == 4)
        assert(result[0] == 2)
        assert(result[1] == 4)
        assert(result[2] == 6)
        assert(result[3] == 8)
    }

    test "chain with filter" {
        let a = [1, 2, 3]
        let b = [4, 5, 6]
        let result = a.iter().chain(b.iter()).filter((x) => x % 2 == 0).collect()
        assert(result.length() == 3)
        assert(result[0] == 2)
        assert(result[1] == 4)
        assert(result[2] == 6)
    }

    test "chain with count" {
        let a = [1, 2, 3]
        let b = [4, 5]
        let count = a.iter().chain(b.iter()).count()
        assert(count == 5)
    }

    test "chain with sum" {
        let a = [1, 2, 3]
        let b = [4, 5]
        let sum = a.iter().chain(b.iter()).sum()
        assert(sum == 15)
    }

    test "chain with first and last" {
        let a = [1, 2]
        let b = [3, 4]
        let first = a.iter().chain(b.iter()).first()
        let last = a.iter().chain(b.iter()).last()
        assert(first != nil)
        assert((first ?? 0) == 1)
        assert(last != nil)
        assert((last ?? 0) == 4)
    }
}
