// Record tests

record Point {
    x: i32,
    y: i32,

    func sum() -> i32 {
        return self.x + self.y
    }

    // Expression-bodied method using self
    func product() -> i32 => self.x * self.y

    // Expression-bodied with inferred return type
    func doubled() => Point { x: self.x * 2, y: self.y * 2 }
}

tests "records" {
    test "basic instantiation" {
        let p = Point { x: 10, y: 20 }
        assert(p.x == 10)
        assert(p.y == 20)
    }

    test "field access" {
        let p = Point { x: 5, y: 7 }
        assert(p.x + p.y == 12)
    }

    test "method call" {
        let p = Point { x: 10, y: 20 }
        assert(p.sum() == 30)
    }

    test "expression-bodied method with self" {
        let p = Point { x: 3, y: 4 }
        assert(p.product() == 12)
    }

    test "expression-bodied method returning record" {
        let p = Point { x: 5, y: 7 }
        let d = p.doubled()
        assert(d.x == 10)
        assert(d.y == 14)
    }

    // Note: Record immutability is tested via expect-error in sema tests
    // Records cannot have their fields mutated after creation
}
