// FAILING TEST - see ticket v-836d
// Class-level type constraints not propagated to method bodies

let Disposable: type = { func dispose() -> void }

record Resource {
    id: i64,
    func dispose() -> void { print("Disposing " + self.id.to_string()) }
}

class Manager<T: Disposable> {
    item: T,
    
    func cleanup() -> void {
        // This should work since T: Disposable, but fails with:
        // "unknown method 'dispose' on type 'T'"
        self.item.dispose()
    }
}

tests "class-level constraints in methods" {
    test "method can use class type param constraint" {
        let mgr: Manager<Resource> = Manager { item: Resource { id: 1 } }
        mgr.cleanup()
    }
}
