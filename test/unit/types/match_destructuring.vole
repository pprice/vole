// Match arm destructuring tests

record Point { x: i64, y: i64 }
record Person { name: string, age: i64 }

tests {
    test "basic typed record pattern in match" {
        let p = Point { x: 10, y: 20 }
        let result = match p {
            Point { x, y } => x + y
        }
        assert(result == 30)
    }

    test "typed record pattern with rename" {
        let p = Point { x: 5, y: 15 }
        let result = match p {
            Point { x: a, y: b } => a * b
        }
        assert(result == 75)
    }

    test "partial typed record pattern" {
        let p = Point { x: 100, y: 200 }
        let result = match p {
            Point { x } => x
        }
        assert(result == 100)
    }

    test "typed record pattern with string field" {
        let person = Person { name: "Alice", age: 30 }
        let result = match person {
            Person { name, age } => age
        }
        assert(result == 30)
    }

    test "mixed rename pattern" {
        let p = Point { x: 7, y: 8 }
        let result = match p {
            Point { x, y: second } => x + second
        }
        assert(result == 15)
    }
}
