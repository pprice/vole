// Test static methods on records and classes

record Point {
    x: i64,
    y: i64,

    statics {
        func origin() -> Point {
            return Point { x: 0, y: 0 }
        }

        func from_x(x: i64) -> Point {
            return Point { x: x, y: 0 }
        }
    }
}

class Counter {
    value: i64,

    statics {
        func zero() -> Counter {
            return Counter { value: 0 }
        }

        func starting_at(v: i64) -> Counter {
            return Counter { value: v }
        }
    }

    func increment() {
        self.value = self.value + 1
    }
}

tests {
    test "record static method - origin" {
        let p = Point.origin()
        assert(p.x == 0)
        assert(p.y == 0)
    }

    test "record static method with params" {
        let p = Point.from_x(42)
        assert(p.x == 42)
        assert(p.y == 0)
    }

    test "class static method - zero" {
        let c = Counter.zero()
        assert(c.value == 0)
    }

    test "class static method with params" {
        let c = Counter.starting_at(10)
        assert(c.value == 10)
        c.increment()
        assert(c.value == 11)
    }

    // Tests for static interfaces
    test "Default interface - i32" {
        let v = i32.default_value()
        assert(v == 0)
    }

    test "Default interface - i64" {
        let v = i64.default_value()
        assert(v == 0)
    }

    test "Default interface - bool" {
        let v = bool.default_value()
        assert(v == false)
    }

    test "Default interface - string" {
        let v = string.default_value()
        assert(v == "")
    }

    test "Bounded interface - i32" {
        assert(i32.min_value() == -2147483648)
        assert(i32.max_value() == 2147483647)
    }

    test "Bounded interface - i64" {
        assert(i64.min_value() == -9223372036854775807 - 1)
        assert(i64.max_value() == 9223372036854775807)
    }

    test "Zero and One interfaces" {
        assert(i32.zero() == 0)
        assert(i32.one() == 1)
        assert(i64.zero() == 0)
        assert(i64.one() == 1)
    }
}
