// Tests for exhaustive return analysis
// Functions with exhaustive if/else returning in all branches don't need trailing returns

// Basic exhaustive if/else - no trailing return needed
func sign(x: i64) -> i64 {
    if x > 0 {
        return 1
    } else if x < 0 {
        return -1
    } else {
        return 0
    }
}

// Simple if/else - both branches return
func abs(x: i64) -> i64 {
    if x >= 0 {
        return x
    } else {
        return -x
    }
}

// Nested exhaustive if/else
func classify(x: i64, y: i64) -> string {
    if x > 0 {
        if y > 0 {
            return "both positive"
        } else {
            return "x positive, y non-positive"
        }
    } else {
        if y > 0 {
            return "x non-positive, y positive"
        } else {
            return "both non-positive"
        }
    }
}

// Match-like if/else chain
func numToWord(n: i64) -> string {
    if n == 1 {
        return "one"
    } else if n == 2 {
        return "two"
    } else if n == 3 {
        return "three"
    } else {
        return "other"
    }
}

// Early return followed by exhaustive if/else
func safeDiv(x: i64, y: i64) -> i64 {
    if y == 0 {
        return 0
    }
    if x >= 0 {
        return x / y
    } else {
        return -((-x) / y)
    }
}

// Function with exhaustive if/else on multiple inputs (like a method would have)
func quadrant(x: i64, y: i64) -> i64 {
    if x >= 0 {
        if y >= 0 {
            return 1
        } else {
            return 4
        }
    } else {
        if y >= 0 {
            return 2
        } else {
            return 3
        }
    }
}

tests "exhaustive returns" {
    test "sign positive" {
        assert(sign(5) == 1)
    }

    test "sign negative" {
        assert(sign(-5) == -1)
    }

    test "sign zero" {
        assert(sign(0) == 0)
    }

    test "abs positive" {
        assert(abs(5) == 5)
    }

    test "abs negative" {
        assert(abs(-5) == 5)
    }

    test "classify both positive" {
        assert(classify(1, 1) == "both positive")
    }

    test "classify x positive y non-positive" {
        assert(classify(1, -1) == "x positive, y non-positive")
    }

    test "classify x non-positive y positive" {
        assert(classify(-1, 1) == "x non-positive, y positive")
    }

    test "classify both non-positive" {
        assert(classify(-1, -1) == "both non-positive")
    }

    test "numToWord one" {
        assert(numToWord(1) == "one")
    }

    test "numToWord two" {
        assert(numToWord(2) == "two")
    }

    test "numToWord other" {
        assert(numToWord(99) == "other")
    }

    test "safeDiv normal" {
        assert(safeDiv(10, 2) == 5)
    }

    test "safeDiv by zero" {
        assert(safeDiv(10, 0) == 0)
    }

    test "safeDiv negative" {
        assert(safeDiv(-10, 2) == -5)
    }

    test "quadrant 1" {
        assert(quadrant(1, 1) == 1)
    }

    test "quadrant 2" {
        assert(quadrant(-1, 1) == 2)
    }

    test "quadrant 3" {
        assert(quadrant(-1, -1) == 3)
    }

    test "quadrant 4" {
        assert(quadrant(1, -1) == 4)
    }
}
