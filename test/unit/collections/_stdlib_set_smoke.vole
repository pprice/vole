// Smoke test: import Set from std:collections/set
let { Set } = import "std:collections/set"

tests {
    test "stdlib set::basic smoke" {
        let s = Set.new<i64>()
        assert(s.add(1))
        assert(s.add(2))
        assert(s.add(3))

        assert(s.len() == 3)
        assert(s.contains(1))
        assert(s.contains(2))
        assert(!s.contains(99))
    }

    test "stdlib set::string values" {
        let s = Set.new<string>()
        assert(s.add("hello"))
        assert(s.add("world"))
        assert(!s.add("hello"))

        assert(s.len() == 2)
        assert(s.contains("hello"))
    }

    test "stdlib set::set algebra" {
        let a = Set.new<i64>()
        _ = a.add(1)
        _ = a.add(2)
        _ = a.add(3)

        let b = Set.new<i64>()
        _ = b.add(2)
        _ = b.add(3)
        _ = b.add(4)

        let u = a.union(b)
        assert(u.len() == 4)

        let i = a.intersection(b)
        assert(i.len() == 2)

        let d = a.difference(b)
        assert(d.len() == 1)
        assert(d.contains(1))

        assert(a.is_subset(u))
        assert(!a.is_disjoint(b))
    }

    test "stdlib set::iterator" {
        let s = Set.new<i64>()
        _ = s.add(10)
        _ = s.add(20)
        _ = s.add(30)

        assert(s.iter().count() == 3)

        let mut sum = 0
        for v in s.iter() {
            sum = sum + v
        }
        assert(sum == 60)
    }
}
