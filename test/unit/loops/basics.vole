// Basic loop tests

tests "for loop basics" {
    test "basic for-in loop over array" {
        let arr = [10, 20, 30]
        var sum = 0
        for x in arr {
            sum = sum + x
        }
        assert(sum == 60)
    }

    test "for-in loop accumulating a sum" {
        var total = 0
        for i in 1..=10 {
            total = total + i
        }
        assert(total == 55)
    }

    test "nested for loops" {
        var sum = 0
        for i in 0..3 {
            for j in 0..4 {
                sum = sum + 1
            }
        }
        assert(sum == 12)
    }

    test "nested for loops with multiplication" {
        var result = 0
        for i in 1..=3 {
            for j in 1..=3 {
                result = result + i * j
            }
        }
        // (1*1+1*2+1*3) + (2*1+2*2+2*3) + (3*1+3*2+3*3) = 6+12+18 = 36
        assert(result == 36)
    }

    test "for loop with break" {
        var last = 0
        for i in 0..100 {
            if i == 5 {
                break
            }
            last = i
        }
        assert(last == 4)
    }

    test "for loop with continue" {
        var sum = 0
        for i in 0..10 {
            if i % 3 == 0 {
                continue
            }
            sum = sum + i
        }
        // skip 0,3,6,9 -> 1+2+4+5+7+8 = 27
        assert(sum == 27)
    }

    test "while loop basic" {
        var i = 0
        var sum = 0
        while i < 5 {
            sum = sum + i
            i = i + 1
        }
        // 0+1+2+3+4 = 10
        assert(sum == 10)
    }

    test "while loop with break" {
        var i = 0
        while true {
            if i == 10 {
                break
            }
            i = i + 1
        }
        assert(i == 10)
    }
}
